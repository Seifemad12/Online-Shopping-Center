#include <iostream>
#include <string>
#include <string.h>
#include <conio.h>

using namespace std;
int LogIndex;

struct shopper1 {
	string name;
	int id;
	char pass[32];
	int age;
	char gender;
	string adress;
}shopper1 s1[1000];

int login();
void registration();
void update(int j);
void SLchoice();
void SEchoice();
int main() {
	SLchoice();
	SEchoice();


	return 0;
}
void registration() {
	int j;
	char choice;
	char flag;
	char a;
	cout << "Do you want to register a new email ? (y/n)" << endl;
	cin >> flag;
	if (flag == 'y' || flag == 'Y') {
		for (int i = 0; i < 32; i++) {
			cout << "Enter your name : ";
			cin >> s1[i].name;
			s1[i].id[i] = i + 1;
			cout << "you id is : " << s1[i].id[i] << endl;

			do {
				cout << endl << "Enter a password of at least 6 digits" << endl;
				cout << endl << "Enter your password : ";
				for (j = 0;;)
				{
					a = _getch();
					if ((a >= 'a'&&a <= 'z') || (a >= 'A'&&a <= 'Z') || (a >= '0'&&a <= '9'))
					{
						s1[j].pass[j] = a;
						++j;
						cout << "*";
					}
					if (a == '\b'&&j >= 1)
					{
						cout << "\b \b";
						--j;
					}
					if (a == '\r')
					{
						s1[j].pass[j] = '\0';
						break;
					}
				}
			} while (j <= 5);
			cout << endl << endl << "Enter your age :";
			cin >> s1[i].age;
			cout << endl << "Enter your Gender : ";
			cin >> s1[i].gender;
			cout << endl << "Enter your adress: ";
			cin >> s1[i].adress;

			cout << endl << "You have registered successfully" << endl;
			cout << "do you want to create another email ? (y/n)" << endl;
			cin >> choice;
			if (choice == 'y' || choice == 'y')
				continue;
			else if (choice == 'N' || choice == 'n')
				break;
		}
	}

}


	int login() {
		int id;
		int j , i;
		char a;
		char password[32];
		bool x = false;
		cout << endl << "enter your id : ";
		cin >> id;
		do {
			cout <<endl << "enter a password of at least 6 digits" << endl;
			cout << endl << "enter your password : ";
			for ( j = 0;;)
			{
				a = _getch();
				if ((a >= 'a'&&a <= 'z') || (a >= 'A'&&a <= 'Z') || (a >= '0'&&a <= '9'))
				{
					password[j] = a;
					++j;
					cout << "*";
				}
				if (a == '\b'&&j >= 1)
				{
					cout << "\b \b";
					--j;
				}
				if (a == '\r')
				{
					password[j] = '\0';
					break;
				}
			}
		} while (j <= 5);
		
	for( i = 0; i < 32; i++) {
			if (id == s1[i].id[i] && password == s1[i].pass) {
				x = true;
			}

		}

		if (x == true) {
			cout << endl << "you are logged in successfully" << endl;
		}
		else {
			cout << endl << "Either the ID or Password is incorrect" << endl;
			i = 1000;
		}
		return i;


	}
	void update(int j) {
		char editchoices, gender;
		int regedit, shopEdit;
		cout << "Editing your information\n";
		cout << "Would you like to edit your registration data (Y/N) ? ";
		cin >> editchoices;
		if (editchoices == 'Y' || editchoices == 'y') {
			cout << "What do you want to edit ? " << endl;
			cout << " 1-Name \n 2-ID \n 3-Password \n 4-Age \n 5-Gender \n 6-Address" << endl;
			cout << "Choice: "; cin >> regedit;
			switch (regedit) {
			case 1: cout << "New Name : ";
				cin >> s1[j].name;
				break;

			case 2:  cout << "New ID : ";
				cin >> s1[j].id[j];
				break;

			case 3: cout << "New Password :";
				cin >> s1[j].pass;
				break;

			case 4: cout << "New Age : ";
				cin >> s1[j].age;
				break;

			case 5: cout << "New Gender(Female/male) : ";
				cin >> gender
				if (gender == 'M' || gender == 'm')
			             {
				s1[j].gender = "Male";
			             }
			        else if (gender == 'F' || gender == 'f')
			             {
				s1[j].gender = "Female";
			             }
			else { cout << "Error"; }
			break;
				
			case 6: cout << "New Address : ";
				cin >> s1[j].adress;
				break;

			default: cout << "Invalid";
				break;
			}
		}
		else { cout << "Invalid Choice"; }
	}
		
	void SLchoice()
	{
		char c;
		char Loginchoice;
		cout << "Do you want to register or login , (R/L)? ";
		cin >> Loginchoice;
		do {
			switch (Loginchoice)
			{
			case 'l':
			case 'L': LogIndex = login();
				break;
			case'r':
			case'R': registration();

			default: cout << "You may continue";
				break;
			}
			if (LogIndex == 1000) {
				cout << "Would you like to try again, (Y/N)? ";
				cin >> c;
			}
			else {
				c = 'n';
			}
		} while (c == 'y' || c == 'Y');
	}

	void SEchoice()
	{
		char Editchoice;
		cout << "Do you want to edit your data , (Y/N)? ";
		cin >> Editchoice;
		switch (Editchoice)
		{
		case'y':
		case'Y':update(LogIndex);
			break;
		default:cout << "You may continue/n";
			break;
		}
	}

